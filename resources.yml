---
resource_types:
  - name: gcs-resource
    type: docker-image
    source:
      repository: frodenas/gcs-resource

resources:

  ## Git Repos ##

  - name: lifecycle-repo
    type: git
    source:
      uri: https://github.com/buildpack/lifecycle.git
      branch: master

  - name: pack-repo
    type: git
    source:
      uri: https://github.com/buildpack/pack.git
      branch: master

  - name: ci
    type: git
    source:
      uri: https://github.com/buildpack/ci.git
      branch: master

  ## Semver ##

  - name: lifecycle-version
    type: semver
    source:
      initial_version: 0.0.3
      driver: gcs
      bucket: cloud-native-buildpacks-versions
      key: lifecycle-version
      json_key: ((concourse-service-account-key-json))

  - name: pack-version
    type: semver
    source:
      initial_version: 0.1.0
      driver: gcs
      bucket: cloud-native-buildpacks-versions
      key: pack-version
      json_key: ((concourse-service-account-key-json))

  ## Docker Images ##

  - name: packs-base-image
    type: docker-image
    source:
      repository: gcr.io:443/cncf-buildpacks-ci/packs/base # port needed for private repos
      username: _json_key
      password: ((concourse-service-account-key-json))

  - name: packs-run-image
    type: docker-image
    source:
      repository: gcr.io:443/cncf-buildpacks-ci/packs/run # port needed for private repos
      username: _json_key
      password: ((concourse-service-account-key-json))

  - name: packs-build-image
    type: docker-image
    source:
      repository: gcr.io:443/cncf-buildpacks-ci/packs/build # port needed for private repos
      username: _json_key
      password: ((concourse-service-account-key-json))

  - name: packs-samples-image
    type: docker-image
    source:
      repository: gcr.io:443/cncf-buildpacks-ci/packs/samples # port needed for private repos
      username: _json_key
      password: ((concourse-service-account-key-json))

  ## GCS Buckets ##

  - name: detector-gcs
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-lifecycle-binaries
      json_key: ((concourse-service-account-key-json))
      regexp: development/detector-(.*)

  - name: analyzer-gcs
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-lifecycle-binaries
      json_key: ((concourse-service-account-key-json))
      regexp: development/analyzer-(.*)

  - name: builder-gcs
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-lifecycle-binaries
      json_key: ((concourse-service-account-key-json))
      regexp: development/builder-(.*)

  - name: exporter-gcs
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-lifecycle-binaries
      json_key: ((concourse-service-account-key-json))
      regexp: development/exporter-(.*)

  - name: launcher-gcs
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-lifecycle-binaries
      json_key: ((concourse-service-account-key-json))
      regexp: development/launcher-(.*)

  - name: latest-lifecycle-archive-dev
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-lifecycle-binaries
      json_key: ((concourse-service-account-key-json))
      versioned_file: development/lifecycle-binaries-latest.tgz

  - name: latest-lifecycle-archive-prod
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-lifecycle-binaries
      json_key: ((concourse-service-account-key-json))
      versioned_file: release/lifecycle-binaries-latest.tgz

  - name: pack-linux-binary
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-pack-binaries
      json_key: ((concourse-service-account-key-json))
      regexp: development/pack-(.*)-linux

  - name: pack-darwin-binary
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-pack-binaries
      json_key: ((concourse-service-account-key-json))
      regexp: development/pack-(.*)-darwin

  - name: pack-windows-binary
    type: gcs-resource
    source:
      bucket: cloud-native-buildpacks-pack-binaries
      json_key: ((concourse-service-account-key-json))
      regexp: development/pack-(.*)-windows

  ## Github Releases ##

  - name: pack-github-release
    type: github-release
    source:
      owner: buildpack
      repository: ci # TODO: Point to buildpack/pack later
      drafts: true
      access_token: ((pack-github-release-token)) # TODO: Make bot user


